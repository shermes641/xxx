<div id="modal-overlay" class="modal-overlay"></div>
<div id="waterfall-controller">
    <div ng-show="waterfallInfoCallComplete" id="waterfall-page">
        <div ng-include="subHeader"></div>
        <div ng-include="appList"></div>
        <div id="waterfall-edit" class="split-content waterfall-list">
            <div ng-hide="flashMessage.text() === '' || modalShown" id="waterfall-edit-message" class="full-{{flashMessage.displayClass()}}-message">
                {{flashMessage.text()}}
            </div>
            <div ng-show="waterfallData.waterfall.testMode" id="test-mode-message" class="full-static-message">
                You are currently working in Test Mode. Reward settings will not be observed.
            </div>
            <div ng-show="waterfallData.waterfall.paused && !waterfallData.waterfall.testMode" id="paused-mode-message" class="full-static-message">
                Your waterfall is currently paused
            </div>
            <div id="edit-top">
                <h1 class="preserve-whitespace">{{appName}} Waterfall</h1>
            </div>
            <div id="waterfall-sub-header">
                <modal-dialog show='modalShown'>
                    <div id="edit-app" ng-show="showEditAppModal">
                        <div ng-include="editAppModal"></div>
                    </div>
                    <div id="create-app" ng-show="showNewAppModal">
                        <div ng-include="newAppModal"></div>
                    </div>
                    <div id="edit-waterfall-ad-provider" ng-show="showWaterfallAdProviderModal">
                        <div ng-include="editWaterfallAdProviderModal"></div>
                    </div>
                    <div id="test-mode-confirmation" ng-show="showTestModeConfirmationModal">
                        <div ng-include="testModeConfirmationModal"></div>
                    </div>
                </modal-dialog>
                <div class="waterfall-buttons first">
                    <h4 ng-mouseenter="hoverOptimized=true" ng-mouseleave="hoverOptimized=false" class="tooltip">
                        ?
                        <div class="ngtooltip" ng-show="hoverOptimized">Optimized Mode will ensure that your waterfall will be ordered by eCPM with the highest paying partners at the top.</div>
                    </h4>
                    <label class="text-label">Optimized Mode</label>
                    <div class="onoffswitch">
                        <input ng-click="toggleOptimizedMode()" ng-model="waterfallData.waterfall.optimizedOrder" type="checkbox" name="optimized-order" class="onoffswitch-checkbox" id="optimized-mode-switch">
                        <label class="onoffswitch-label" for="optimized-mode-switch">
                            <span class="onoffswitch-inner"></span>
                            <span class="onoffswitch-switch"></span>
                        </label>
                    </div>
                </div>
                <div class="waterfall-status">
                    <h4 ng-mouseenter="hoverStatusMode=true" ng-mouseleave="hoverStatusMode=false" class="tooltip">
                        ?
                        <div class="ngtooltip" ng-show="hoverStatusMode">Switch between available waterfall modes.</div>
                    </h4>
                    <label class="text-label">Waterfall Status</label>
                    <div class="waterfall-status-container">
                        <div id="status-toggle" ng-class="{live: !waterfallData.waterfall.testMode, paused: waterfallData.waterfall.paused}"></div>
                        <span id="test-mode-switch" ng-click="activateTestMode()">Test</span>
                        <span id="live-mode-switch" ng-click="activateLiveMode()">Live</span>
                        <span id="pause-mode-switch" ng-click="activatePausedMode()">Pause</span>
                    </div>
                </div>
            </div>

            <div id="initialize-sdk" ng-click="toggleCodeBlock()" ng-class="{open: showCodeBlock}" ng-show="waterfallData.waterfall.testMode">
                <div id="arrow-dropdown"></div>
                Initialize hyprMediate in your SDK
                <div class="code-block">
                    <div class="waterfall-edit-description" ng-click="$event.stopPropagation()">
                        Copy and paste this following code, wherever you plan on initializing HyprMediate.  For a step by step integration guide and suggestions on generating a user ID, please see our <a id="sdk-documentation-link" target="_blank" href="http://documentation.hyprmx.com/display/IS/iOS+SDK">documentation</a>.
                    </div>
                    <code class="waterfall-edit-description copy-paste-code" ng-click="$event.stopPropagation()">
                        // See documentation for suggestions on how to define hyprUserId.
                        <br/>
                        [HYPRMediate initialize:@"{{waterfallData.waterfall.appToken}}" userId:hyprUserId];
                    </code>
                </div>
            </div>

            <div class="waterfall ul">
                <ul ui-sortable="sortableOptions" ng-model="waterfallData.waterfallAdProviderList" id="waterfall-list" class="waterfall-sort">
                    <li ng-repeat="adProviderConfig in waterfallData.waterfallAdProviderList" id="{{adProviderConfig.name}}" ng-class="{waterfall: adProviderConfig.active, inactive: '', 'below-reward-threshold': !adProviderConfig.meetsRewardThreshold && !adProviderConfig.pending}">
                        <div ng-class="{'hideable hideable-wap-info': adProviderConfig.active, 'hideable hidden-wap-info': ''}">
                            <div class="waterfall-app-info">
                                <div class="pending-status" ng-show="{{adProviderConfig.pending}}">
                                    <h4>{{adProviderConfig.name}} is Pending</h4>
                                    <h5>To check if it's ready, please refresh your browser.</h5>
                                </div>
                                <div ng-hide="{{adProviderConfig.pending}}">
                                    <h3>{{adProviderConfig.name}}</h3>
                                    <span ng-hide="adProviderConfig.cpm === null">
                                        <label>eCPM:</label>
                                        <div name="cpm" style="display: inline-block;">${{adProviderConfig.cpm | monetaryFormat}}</div>
                                    </span>
                                    <span class="below-reward-threshold-message" ng-hide="adProviderConfig.meetsRewardThreshold">
                                        This Ad Network doesn't meet the minimum eCPM requirements
                                    </span>
                                </div>
                            </div>
                            <div ng-hide="{{adProviderConfig.pending}}" class="wap-buttons">
                                <button ng-hide="adProviderConfig.unconfigured" ng-click="toggleWAPStatus(adProviderConfig)" class="status" ng-class="{active: adProviderConfig.active, inactive: !adProviderConfig.active, loading: adProviderConfig.loading}" type="submit" name="status">
                                    <div class="icon"></div>
                                    <label>{{adProviderConfig.active | waterfallStatus}}</label>
                                    <div class="deactivate">Deactivate</div>
                                    <div class="activate">Activate</div>
                                </button>
                                <div ng-show="adProviderConfig.configurable" ng-click="editWaterfallAdProvider(adProviderConfig)" class="configure active-button" type="submit"></div>
                            </div>
                            <div ng-hide="waterfallData.optimizedMode" class="waterfall-drag">
                                <div class="waterfall-drag-1"></div>
                                <div class="waterfall-drag-2"></div>
                                <div class="waterfall-drag-3"></div>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>
